"use strict";(self.webpackChunkNovaChatAppReact=self.webpackChunkNovaChatAppReact||[]).push([[308],{62308:function(e,t,s){s.r(t);var i=s(15671),a=s(43144),n=s(60136),o=s(29388),r=s(72791),l=s(376),c=s(77027),d=s(87309),h=s(9555),u=s(23253),g=s(77558),p=s(30588),f=s(11730),v=(s(31381),s(59354)),y=s(72426),m=s.n(y),x=s(80184),S=l.Z.Search,j=function(e){(0,n.Z)(s,e);var t=(0,o.Z)(s);function s(){var e;(0,i.Z)(this,s);for(var a=arguments.length,n=new Array(a),o=0;o<a;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))).state={page:0,pageSize:10,total:0,sort:0,sortKey:"",wordsList:[],typeList:[],botId:0,chatDate:"",status:-1,search:"",totalUsage:0,selectedRowKeys:[],isGetting:!1,isEditOpen:!1,selectObj:{},selectObjError:{},isDeleteOpen:!1,deleteId:0},e}return(0,a.Z)(s,[{key:"componentDidMount",value:function(){this.getTypeList(),this.getWordsList()}},{key:"changeSearch",value:function(e){this.setState({search:e.target.value})}},{key:"getWordsList",value:function(e){var t=this;this.setState({isGetting:!0});var s={PageNumber:this.state.page,PageSize:this.state.pageSize,ItemId:0,SearchKey:this.state.search,SearchTime:this.state.chatDate,SearchCategory:this.state.botId};v.Z.post("/api/SensitiveWord/List",s).then((function(e){if(e&&e.success){var s,i,a=e.data;t.setState({wordsList:a,isGetting:!1,total:e.totalCount}),null===(s=(i=t.props).setToken)||void 0===s||s.call(i,e.message)}else t.setState({wordsList:[],isGetting:!1}),console.log(e.message),c.ZP.error(e.message)})).catch((function(e){t.setState({wordsList:[],isGetting:!1})}))}},{key:"getTypeList",value:function(){var e=this;v.Z.get("/api/SensitiveWord/category_list").then((function(t){if(t&&t.success){var s=t.data;s.forEach((function(e){e.label=e.category,e.value=e.id})),e.setState({typeList:s})}})).catch((function(t){e.setState({typeList:[]})}))}},{key:"openEditer",value:function(e){var t={id:e.id||0,title:e.content||"",category:e.category_Id};this.setState({isEditOpen:!0,selectObj:t})}},{key:"editWord",value:function(e,t){var s=this.state,i=s.selectObj,a=s.selectObjError;i[t]=e,a[t]=!e,this.setState({selectObj:i,selectObjError:a})}},{key:"handleEdit",value:function(){var e=this,t=this.state,s=t.selectObj,i=t.selectObjError,a=0;if(s.title||(i.title=!0,a++),s.category||(i.category=!0,a++),this.setState({selectObjError:i}),!(a>0)){var n={Id:s.id,Category_Id:s.category,Content:s.title};v.Z.post("/api/SensitiveWord/Save",n).then((function(t){t.success?(e.setState({isEditOpen:!1,selectObj:{},selectObjError:{}}),c.ZP.success(e.props.t("Saved Success")),e.getWordsList()):c.ZP.error(t.message)})).catch((function(e){c.ZP.error(e.message)}))}}},{key:"openDelete",value:function(e){this.setState({isDeleteOpen:!0,deleteId:null===e||void 0===e?void 0:e.id})}},{key:"handleDelete",value:function(){var e=this,t=this.state,s=t.deleteId,i=t.selectedRowKeys,a=s?[s]:i;v.Z.post("/api/SensitiveWord/delete",a).then((function(t){t.success?(e.setState({isDeleteOpen:!1,deleteId:0,selectedRowKeys:[]}),c.ZP.success(e.props.t("Deleted Success")),e.getWordsList()):c.ZP.error(t.message)})).catch((function(e){c.ZP.error(e.message)}))}},{key:"render",value:function(){var e=this,t=this.props.t,s=this.state,i=s.selectObj,a=s.selectObjError,n=[{title:t("general.Number"),dataIndex:"index",render:function(t,s,i){return i+1+e.state.page*e.state.pageSize},width:100,fixed:"left"},{title:t("\u6807\u9898"),dataIndex:"content",width:200,fixed:"left"},{title:t("\u7c7b\u578b"),dataIndex:"category",width:200},{title:t("\u66f4\u65b0\u65e5\u671f"),dataIndex:"updated_At",render:function(e,t){return m()(e).format("YYYY-MM-DD  HH:mm")||"-"},width:200},{title:t("\u64cd\u4f5c"),dataIndex:"operate",render:function(s,i){return(0,x.jsxs)("div",{className:"operate_box",children:[(0,x.jsx)(d.ZP,{size:"small",type:"text",onClick:function(){e.openEditer(i)},children:(0,x.jsx)("span",{className:"text",children:t("\u7f16\u8f91")})}),(0,x.jsx)("div",{className:"devide_line"}),(0,x.jsx)(d.ZP,{size:"small",type:"text",onClick:function(){e.openDelete(i)},children:(0,x.jsx)("span",{className:"text",children:t("\u5220\u9664")})})]})},width:100,fixed:"right"}];return(0,x.jsxs)("div",{className:"sensitive_word",children:[(0,x.jsxs)("div",{className:"sw_header",children:[(0,x.jsxs)("div",{className:"sw_header_lt",children:[(0,x.jsx)(h.Z,{showSearch:!0,placeholder:t("\u8bf7\u9009\u62e9\u7c7b\u522b"),optionFilterProp:"children",onChange:function(t){e.setState({botId:t||0,page:0},(function(){e.getWordsList()}))},onSearch:function(){},filterOption:function(e,t){var s;return(null!==(s=null===t||void 0===t?void 0:t.label)&&void 0!==s?s:"").toLowerCase().includes(e.toLowerCase())},options:this.state.typeList,style:{width:200},allowClear:!0,size:"large"}),(0,x.jsx)(u.Z,{onChange:function(t,s){e.setState({chatDate:s,page:0},(function(){e.getWordsList()}))},style:{width:200,marginLeft:"1rem"},placeholder:t("\u8bf7\u9009\u62e9\u65e5\u671f"),size:"large"})]}),(0,x.jsxs)("div",{className:"sw_header_gt",children:[(0,x.jsx)(S,{value:this.state.search,placeholder:t("\u8bf7\u8f93\u5165\u5173\u952e\u5b57"),onChange:function(t){e.changeSearch(t)},onSearch:function(){e.getWordsList()},className:"sx_search",enterButton:(0,x.jsxs)("div",{className:"search_btn",children:[(0,x.jsx)(f.Z,{}),t("\u641c\u7d22")]}),style:{width:400},size:"large"}),(0,x.jsx)(d.ZP,{className:"sx_del",size:"large",onClick:function(){e.openDelete()},disabled:0===this.state.selectedRowKeys.length,children:t("\u5220\u9664")}),(0,x.jsx)(d.ZP,{className:"sx_add",size:"large",onClick:function(){e.openEditer({})},children:t("\u6dfb\u52a0")})]})]}),(0,x.jsx)("div",{className:"sw_content",children:(0,x.jsx)(g.Z,{columns:n,dataSource:this.state.wordsList,loading:this.state.isGetting,onChange:function(t,s,i){var a;e.state.isGetting||e.setState({page:t.current-1,pageSize:t.pageSize,sort:"descend"===i.order?1:0,sortKey:(null===(a=i.column)||void 0===a?void 0:a.dataIndex)||"",selectedRowKeys:[]},(function(){e.getWordsList()}))},pagination:{total:this.state.total,pageSize:this.state.pageSize,current:this.state.page+1,showSizeChanger:!0,showQuickJumper:!0,showTotal:function(e,t){return"".concat(t[0],"-").concat(t[1]," of ").concat(e," items")}},rowKey:function(e){return e.id},rowSelection:{selectedRowKeys:this.state.selectedRowKeys,onChange:function(t,s){e.setState({selectedRowKeys:t})}},scroll:{x:1e3}})}),(0,x.jsx)(p.Z,{title:t("Edit user"),open:this.state.isEditOpen,onOk:function(){e.handleEdit()},onCancel:function(){e.setState({isEditOpen:!1})},children:(0,x.jsxs)("div",{className:"sw_form",children:[(0,x.jsx)("div",{className:"ul_form_title",children:t("Title")}),(0,x.jsx)(l.Z,{value:i.title,status:a.title?"error":"",onChange:function(t){e.editWord(t.target.value,"title")}}),a.title&&(0,x.jsx)("div",{className:"ul_form_info",children:t("Please input the sensitive word!")}),(0,x.jsx)("div",{className:"ul_form_title",children:t("Category")}),(0,x.jsx)(h.Z,{value:i.category,status:a.category?"error":"",onChange:function(t){e.editWord(t,"category")},options:this.state.typeList,allowClear:!0,style:{width:"100%"}}),a.category&&(0,x.jsx)("div",{className:"ul_form_info",children:t("Please select the category!")})]})}),(0,x.jsx)(p.Z,{title:t("Delete"),open:this.state.isDeleteOpen,onOk:function(){e.handleDelete()},onCancel:function(){e.setState({isDeleteOpen:!1})},children:(0,x.jsx)("div",{className:"ul_form",children:(0,x.jsx)("div",{className:"ul_form_title",children:t("Are you sure to delete the user?")})})})]})}}]),s}(r.Component);t.default=j},31381:function(){}}]);
//# sourceMappingURL=308.8cb0811c.chunk.js.map